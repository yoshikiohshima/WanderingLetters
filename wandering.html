<html>
<head>

<script type="text/javascript" src="js/prototype.js"></script>
<script type="text/javascript" src="fx/flapjax.js"></script>

<title>Flapjax Demo: Wanderling Letters</title>

<script type="text/javascript">

function loader() {

  // A function from the mailing list archive to watch the position change.
  // rightB :: Element -> Behavior cumulative position of right edge
  function rightB(t_) {
    var t = $(t_); // adds Prototype methods
    var f = function() {
      var size = t.getDimensions();
      return parseFloat(t['style'].getPropertyValue('left')) + size.width;
    };
    return $E(t, "DOMAttrModified")
     .filterE(function(x) { return x.attrName == "style";})
     .mapE(f)
     .startsWith(f());
  }

  function topB(t_) {
    var t = $(t_); // adds Prototype methods
    var f = function() {
      var size = t.getDimensions();
      return parseFloat(t['style'].getPropertyValue('top'));
    };
    return $E(t, "DOMAttrModified")
     .filterE(function(x) { return x.attrName == "style";})
     .mapE(f)
     .startsWith(f());
  }

  // Make a timer and pos0B that starts from 0 and ten pixels toward right for
  // each seconds.

  ary = 'Hello'.split('');

  var t = timerB(100);
  var start = valueNow(t);

  //var pos0B = t.liftB(function(x) {return (x - start) / 100});

  insertDomB(
    DIV({style: { position: 'absolute',
                  left: mouseLeftB(document),
                  top: mouseTopB(document) }, id: 'p0'},
        'H'),
    'p0');

  for (i = 1; i < 5; i++) {
    id = 'p' + i;
    prevId = 'p' + (i-1);
    insertDomB(
      DIV({style: { position: 'absolute',
                    left: delayB(rightB(prevId), 300),
                    top: topB(prevId) }, id: id},
          ary[i]),
      id);
  }
}
</script>
</head>
<body onload="loader()">
<span id="p0">H</span>
<span id="p1">e</span>
<span id="p2">l</span>
<span id="p3">l</span>
<span id="p4">o</span>
</body>
</html>

