<html>
<head>

<script type="text/javascript" src="fx/flapjax.js"></script>

<title>Flapjax Demo: Wanderling Letters</title>

<script type="text/javascript">

function loader() {

  var ary = 'Hello'.split('');

  ary.forEach(function(x, i) {
    var str = "<span id=p" + i + ">" + x + "</span>";
    document.write(str);
  });

  var t = timerB(100);
  var start = valueNow(t);
  var pos0B = t.liftB(function(x) {return (x - start) / 100});

  insertDomB(
    DIV({style: { position: 'absolute',
                  left: pos0B,
                  top: 0 }},
        'H'),
    'p0');

  // posB :: Element -> Behavior { left, top, width, height: String }
  function posB(t_) {
    var t = $(t_); // adds Prototype methods
    var f = function() {
      var pos = t.cumulativeOffset();
      var size = t.getDimensions();
      return { left : pos.left, top: pos.top,
               height: size.height, width: size.width }};
    return $E(t, "DOMAttrModified")
     .filterE(function(x) { return x.attrName == "style"; })
     .mapE(f)
     .startsWith(f());
  }

  var pos1B = liftB(function(x) {return x[left] + 20;}, posB('p0'));

  insertDomB(
    DIV({style: { position: 'absolute',
                  left: pos1B,
                  top: 0 }},
        'e'),
    'p1');

}
</script>
</head>
<body onload="loader()">
</body>
</html>
